{
  "info": {
    "name": "QuickCook API",
    "description": "Full CRUD RESTful API for the QuickCook recipe management application. Built with Node.js, Express, and PostgreSQL. JWT authentication protects all recipe and ingredient routes. Run requests in order — Register/Login first to set the {{token}} variable, then proceed through Recipes and Ingredients.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "https://sprint1-backend-u1ka.onrender.com",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string",
      "description": "JWT Bearer token — auto-set after Register or Login"
    },
    {
      "key": "recipe_id",
      "value": "",
      "type": "string",
      "description": "Auto-set after Create Recipe"
    },
    {
      "key": "ingredient_id",
      "value": "",
      "type": "string",
      "description": "Auto-set after Add Ingredient"
    }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 201 Created', function () {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "pm.test('Response has token', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.have.property('token');",
                  "  pm.collectionVariables.set('token', body.token);",
                  "});",
                  "pm.test('Response has user object', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.user).to.have.property('id');",
                  "  pm.expect(body.user).to.have.property('email');",
                  "  pm.expect(body.user).to.not.have.property('password_hash');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"abhinandan\",\n  \"email\": \"abhinandan@example.com\",\n  \"password\": \"securepassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "register"]
            },
            "description": "Creates a new user. Password is hashed with bcrypt before storage. Returns a JWT token valid for 7 days. Token is auto-saved to {{token}}."
          },
          "response": [
            {
              "name": "201 Created — User registered",
              "status": "Created",
              "code": 201,
              "body": "{\n  \"message\": \"User registered successfully.\",\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"user\": {\n    \"id\": 1,\n    \"username\": \"abhinandan\",\n    \"email\": \"abhinandan@example.com\",\n    \"created_at\": \"2026-02-27T00:00:00.000Z\"\n  }\n}"
            },
            {
              "name": "409 Conflict — Email already registered",
              "status": "Conflict",
              "code": 409,
              "body": "{\n  \"error\": \"Email is already registered.\"\n}"
            }
          ]
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Response has token', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.have.property('token');",
                  "  pm.collectionVariables.set('token', body.token);",
                  "});",
                  "pm.test('Password hash is not exposed', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.user).to.not.have.property('password_hash');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"abhinandan@example.com\",\n  \"password\": \"securepassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Authenticates an existing user and returns a JWT token. Token is auto-saved to {{token}} for use in all protected routes."
          },
          "response": [
            {
              "name": "200 OK — Login successful",
              "status": "OK",
              "code": 200,
              "body": "{\n  \"message\": \"Login successful.\",\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"user\": {\n    \"id\": 1,\n    \"username\": \"abhinandan\",\n    \"email\": \"abhinandan@example.com\",\n    \"created_at\": \"2026-02-27T00:00:00.000Z\"\n  }\n}"
            },
            {
              "name": "401 Unauthorized — Invalid credentials",
              "status": "Unauthorized",
              "code": 401,
              "body": "{\n  \"error\": \"Invalid email or password.\"\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Recipes",
      "item": [
        {
          "name": "Create Recipe",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 201 Created', function () {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "pm.test('Recipe has id and title', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.recipe).to.have.property('id');",
                  "  pm.expect(body.recipe.title).to.eql('Spaghetti Carbonara');",
                  "  pm.collectionVariables.set('recipe_id', body.recipe.id);",
                  "});",
                  "pm.test('Ingredients are returned', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.recipe.ingredients).to.be.an('array');",
                  "  pm.expect(body.recipe.ingredients.length).to.be.above(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Spaghetti Carbonara\",\n  \"description\": \"Classic Italian pasta dish\",\n  \"instructions\": \"1. Cook pasta. 2. Fry pancetta. 3. Mix eggs and cheese. 4. Combine all.\",\n  \"prep_time\": 20,\n  \"servings\": 4,\n  \"category\": \"Dinner\",\n  \"image_url\": \"\",\n  \"ingredients\": [\n    { \"name\": \"Spaghetti\", \"quantity\": \"400\", \"unit\": \"g\" },\n    { \"name\": \"Eggs\", \"quantity\": \"4\", \"unit\": \"pcs\" },\n    { \"name\": \"Pancetta\", \"quantity\": \"150\", \"unit\": \"g\" },\n    { \"name\": \"Parmesan\", \"quantity\": \"100\", \"unit\": \"g\" }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/recipes",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes"]
            },
            "description": "Creates a new recipe with ingredients in one request. The created recipe ID is auto-saved to {{recipe_id}} for use in subsequent requests."
          },
          "response": [
            {
              "name": "201 Created — Recipe created",
              "status": "Created",
              "code": 201,
              "body": "{\n  \"message\": \"Recipe created successfully.\",\n  \"recipe\": {\n    \"id\": 1,\n    \"user_id\": 1,\n    \"title\": \"Spaghetti Carbonara\",\n    \"category\": \"Dinner\",\n    \"prep_time\": 20,\n    \"servings\": 4,\n    \"ingredients\": [\n      { \"id\": 1, \"name\": \"Spaghetti\", \"quantity\": \"400\", \"unit\": \"g\" }\n    ]\n  }\n}"
            },
            {
              "name": "400 Bad Request — Missing title",
              "status": "Bad Request",
              "code": 400,
              "body": "{\n  \"error\": \"Recipe title is required.\"\n}"
            }
          ]
        },
        {
          "name": "Get All Recipes",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Response is an array', function () {",
                  "  pm.expect(pm.response.json()).to.be.an('array');",
                  "});",
                  "pm.test('At least one recipe exists', function () {",
                  "  pm.expect(pm.response.json().length).to.be.above(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": {
              "raw": "{{base_url}}/api/recipes",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes"],
              "query": [
                { "key": "search", "value": "pasta", "disabled": true, "description": "Optional title filter" },
                { "key": "category", "value": "Dinner", "disabled": true, "description": "Optional category filter" }
              ]
            },
            "description": "Returns all recipes for the authenticated user. Optional query params: ?search= and ?category=."
          },
          "response": [
            {
              "name": "200 OK — Recipes list",
              "status": "OK",
              "code": 200,
              "body": "[\n  {\n    \"id\": 1,\n    \"user_id\": 1,\n    \"title\": \"Spaghetti Carbonara\",\n    \"description\": \"Classic Italian pasta dish\",\n    \"category\": \"Dinner\",\n    \"prep_time\": 20,\n    \"servings\": 4,\n    \"created_at\": \"2026-02-27T00:00:00.000Z\"\n  }\n]"
            },
            {
              "name": "401 Unauthorized — No token",
              "status": "Unauthorized",
              "code": 401,
              "body": "{\n  \"error\": \"Access denied. No token provided.\"\n}"
            }
          ]
        },
        {
          "name": "Get Recipe by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Recipe has ingredients array', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body).to.have.property('id');",
                  "  pm.expect(body).to.have.property('ingredients');",
                  "  pm.expect(body.ingredients).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}"]
            },
            "description": "Returns a single recipe with its full ingredients list. Uses {{recipe_id}} set automatically by Create Recipe."
          },
          "response": [
            {
              "name": "200 OK — Recipe with ingredients",
              "status": "OK",
              "code": 200,
              "body": "{\n  \"id\": 1,\n  \"user_id\": 1,\n  \"title\": \"Spaghetti Carbonara\",\n  \"instructions\": \"1. Cook pasta...\",\n  \"category\": \"Dinner\",\n  \"ingredients\": [\n    { \"id\": 1, \"recipe_id\": 1, \"name\": \"Spaghetti\", \"quantity\": \"400\", \"unit\": \"g\" }\n  ]\n}"
            },
            {
              "name": "404 Not Found",
              "status": "Not Found",
              "code": 404,
              "body": "{\n  \"error\": \"Recipe not found.\"\n}"
            }
          ]
        },
        {
          "name": "Update Recipe",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Title was updated', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.recipe.title).to.eql('Spaghetti Carbonara (Updated)');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Spaghetti Carbonara (Updated)\",\n  \"prep_time\": 25,\n  \"servings\": 2\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}"]
            },
            "description": "Updates an existing recipe. Only the owner can update. Fields not included in the body keep their current values."
          },
          "response": [
            {
              "name": "200 OK — Recipe updated",
              "status": "OK",
              "code": 200,
              "body": "{\n  \"message\": \"Recipe updated successfully.\",\n  \"recipe\": { \"id\": 1, \"title\": \"Spaghetti Carbonara (Updated)\", \"prep_time\": 25, \"servings\": 2 }\n}"
            },
            {
              "name": "404 Not Found",
              "status": "Not Found",
              "code": 404,
              "body": "{\n  \"error\": \"Recipe not found or access denied.\"\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Ingredients",
      "item": [
        {
          "name": "Add Ingredient",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 201 Created', function () {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "pm.test('Ingredient has id', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.ingredient).to.have.property('id');",
                  "  pm.collectionVariables.set('ingredient_id', body.ingredient.id);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"recipe_id\": {{recipe_id}},\n  \"name\": \"Black Pepper\",\n  \"quantity\": \"1\",\n  \"unit\": \"tsp\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ingredients",
              "host": ["{{base_url}}"],
              "path": ["api", "ingredients"]
            },
            "description": "Adds a single ingredient to an existing recipe. Uses {{recipe_id}} set by Create Recipe. The new ingredient ID is auto-saved to {{ingredient_id}}."
          },
          "response": [
            {
              "name": "201 Created — Ingredient added",
              "status": "Created",
              "code": 201,
              "body": "{\n  \"message\": \"Ingredient added.\",\n  \"ingredient\": { \"id\": 5, \"recipe_id\": 1, \"name\": \"Black Pepper\", \"quantity\": \"1\", \"unit\": \"tsp\" }\n}"
            }
          ]
        },
        {
          "name": "Get Ingredients by Recipe",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Response is an array', function () {",
                  "  pm.expect(pm.response.json()).to.be.an('array');",
                  "});",
                  "pm.test('Ingredients exist for this recipe', function () {",
                  "  pm.expect(pm.response.json().length).to.be.above(0);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": {
              "raw": "{{base_url}}/api/ingredients/recipe/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "ingredients", "recipe", "{{recipe_id}}"]
            },
            "description": "Returns all ingredients for a specific recipe. Uses {{recipe_id}} set by Create Recipe."
          },
          "response": [
            {
              "name": "200 OK — Ingredients list",
              "status": "OK",
              "code": 200,
              "body": "[\n  { \"id\": 1, \"recipe_id\": 1, \"name\": \"Spaghetti\", \"quantity\": \"400\", \"unit\": \"g\" },\n  { \"id\": 5, \"recipe_id\": 1, \"name\": \"Black Pepper\", \"quantity\": \"1\", \"unit\": \"tsp\" }\n]"
            }
          ]
        },
        {
          "name": "Update Ingredient",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Ingredient quantity was updated', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.ingredient.quantity).to.eql('2');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"quantity\": \"2\",\n  \"unit\": \"tbsp\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ingredients/{{ingredient_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "ingredients", "{{ingredient_id}}"]
            },
            "description": "Updates a specific ingredient. Uses {{ingredient_id}} set by Add Ingredient."
          },
          "response": [
            {
              "name": "200 OK — Ingredient updated",
              "status": "OK",
              "code": 200,
              "body": "{\n  \"message\": \"Ingredient updated.\",\n  \"ingredient\": { \"id\": 5, \"recipe_id\": 1, \"name\": \"Black Pepper\", \"quantity\": \"2\", \"unit\": \"tbsp\" }\n}"
            }
          ]
        },
        {
          "name": "Delete Ingredient",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Deletion confirmed', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.message).to.eql('Ingredient deleted.');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": {
              "raw": "{{base_url}}/api/ingredients/{{ingredient_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "ingredients", "{{ingredient_id}}"]
            },
            "description": "Deletes a specific ingredient. Uses {{ingredient_id}} set by Add Ingredient."
          },
          "response": [
            {
              "name": "200 OK — Ingredient deleted",
              "status": "OK",
              "code": 200,
              "body": "{\n  \"message\": \"Ingredient deleted.\"\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Cleanup",
      "item": [
        {
          "name": "Delete Recipe",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status is 200 OK', function () {",
                  "  pm.response.to.have.status(200);",
                  "});",
                  "pm.test('Deletion confirmed', function () {",
                  "  const body = pm.response.json();",
                  "  pm.expect(body.message).to.eql('Recipe deleted successfully.');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": {
              "raw": "{{base_url}}/api/recipes/{{recipe_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "recipes", "{{recipe_id}}"]
            },
            "description": "Deletes the recipe created during this test run. Also cascades to delete all its ingredients via the database FK constraint. Uses {{recipe_id}} set by Create Recipe."
          },
          "response": [
            {
              "name": "200 OK — Recipe deleted",
              "status": "OK",
              "code": 200,
              "body": "{\n  \"message\": \"Recipe deleted successfully.\"\n}"
            },
            {
              "name": "404 Not Found",
              "status": "Not Found",
              "code": 404,
              "body": "{\n  \"error\": \"Recipe not found or access denied.\"\n}"
            }
          ]
        }
      ]
    }
  ]
}
